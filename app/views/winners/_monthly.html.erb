<div data-role="content">
  <ul data-role="listview" id="fix-list">
    <% weeks_by_month = {} %>
    <% @weeks.each { |w| weeks_by_month[w.close_date.month.to_s].nil? ? weeks_by_month[w.close_date.month.to_s] = [w.id] : weeks_by_month[w.close_date.month.to_s] << w.id } %>
    <% @weeks.collect(&:close_date).map(&:month).uniq.each do |month_id| %>
        <% winners = @winners.where(number: month_id) %>

        <% if winners.empty? %>
            <li class="custom-list">
              <div class="ui-grid-b event-font">
                <div class="ui-block-a" style="width:20%"><%= "#{DateTime.parse("1900-#{month_id}-01").strftime('%b').upcase}" %></div>
                <div class="ui-block-b" style="width:32%">-</div>
                <div class="ui-block-c" align="right" style="width:14%">-</div>
                <div class="ui-block-c payout-icon" align="right" style="width:14%">-</div>
                <div class="ui-block-d" align="right" style="width:20%">-</div>
              </div>
            </li>
        <% else %>
            <% winners.each do |winner| %>
                <li class="custom-list">
                  <div class="ui-grid-b event-font">
                    <div class="ui-block-a" style="width:20%"><%= "#{DateTime.parse("1900-#{month_id}-01").strftime('%b').upcase}" %></div>
                    <div class="ui-block-b" style="width:32%"><%= winner.user.name %></div>
                    <div class="ui-block-c" align="right" style="width:14%"><%= winner.total %></div>
                    <div class="ui-block-c payout-icon" align="right" style="width:14%"><%= "Â£#{30/winners.count}" %></div>
                    <div class="ui-block-d" align="right" style="width:20%"><%= "#{weeks_by_month[month_id.to_s].count} weeks" %></div>
                  </div>
                </li>
            <% end %>
        <% end %>
    <% end %>
  </ul>
</div>
